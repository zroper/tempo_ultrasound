// COSINE.PRO - Example of using PCL arrays.
//
// A cosine array is loaded and the sine and cosine are computed for
// various angles.
//
// The cosine array contains 1000 elements which range from -10,000 to
// 10,000 (i.e., the cosine in 10,000ths.)  The MAIN process uses it
// to look up sine and cosine values.
//
// Before loading this protocol, you'll need to insure that you've
// allocated enough space for the array.  This is done by editing
// your KERNEL.CFG file and setting ARRAYTABLE to 4100.
//
//          ARRAYTABLE=4100
//
// This allocates 4100 bytes for PCL arrays, leaving a little room for
// more array data.
//
// 27May99 sh   Change sin to sin1 and cos to cos1 to avoid conflict
//              with sin() and cos() functions in the kernel.

// We must declare process names

DECLARE MAIN(), SINE_COSINE();

HIDE cosine[1000] = {
10000, 9999, 9999, 9998, 9996, 9995, 9992, 9990, 9987, 9984, 9980, 9976,
9971, 9966, 9961, 9955, 9949, 9943, 9936, 9928, 9921, 9913, 9904, 9895,
9886, 9876, 9866, 9856, 9845, 9834, 9822, 9810, 9798, 9785, 9772, 9759,
9745, 9730, 9716, 9701, 9685, 9670, 9653, 9637, 9620, 9602, 9585, 9567,
9548, 9529, 9510, 9490, 9470, 9450, 9429, 9408, 9387, 9365, 9343, 9320,
9297, 9274, 9250, 9226, 9202, 9177, 9152, 9126, 9101, 9074, 9048, 9021,
8994, 8966, 8938, 8910, 8881, 8852, 8822, 8793, 8763, 8732, 8701, 8670,
8639, 8607, 8575, 8542, 8509, 8476, 8443, 8409, 8375, 8340, 8305, 8270,
8235, 8199, 8163, 8126, 8090, 8053, 8015, 7977, 7939, 7901, 7862, 7823,
7784, 7745, 7705, 7664, 7624, 7583, 7542, 7501, 7459, 7417, 7375, 7332,
7289, 7246, 7203, 7159, 7115, 7071, 7026, 6981, 6936, 6891, 6845, 6799,
6753, 6706, 6660, 6613, 6565, 6518, 6470, 6422, 6374, 6325, 6276, 6227,
6178, 6129, 6079, 6029, 5979, 5928, 5877, 5826, 5775, 5724, 5672, 5620,
5568, 5516, 5463, 5411, 5358, 5305, 5251, 5198, 5144, 5090, 5036, 4981,
4927, 4872, 4817, 4762, 4707, 4651, 4595, 4539, 4483, 4427, 4371, 4314,
4257, 4200, 4143, 4086, 4029, 3971, 3913, 3855, 3797, 3739, 3681, 3622,
3564, 3505, 3446, 3387, 3328, 3268, 3209, 3149, 3090, 3030, 2970, 2910,
2850, 2789, 2729, 2669, 2608, 2547, 2486, 2425, 2364, 2303, 2242, 2181,
2120, 2058, 1997, 1935, 1873, 1812, 1750, 1688, 1626, 1564, 1502, 1440,
1377, 1315, 1253, 1190, 1128, 1066, 1003, 941, 878, 815, 753, 690, 627,
565, 502, 439, 376, 314, 251, 188, 125, 62, 0, -62, -125, -188, -251,
-314, -376, -439, -502, -565, -627, -690, -753, -815, -878, -941, -1003,
-1066, -1128, -1190, -1253, -1315, -1377, -1440, -1502, -1564, -1626,
-1688, -1750, -1812, -1873, -1935, -1997, -2058, -2120, -2181, -2242,
-2303, -2364, -2425, -2486, -2547, -2608, -2669, -2729, -2789, -2850,
-2910, -2970, -3030, -3090, -3149, -3209, -3268, -3328, -3387, -3446,
-3505, -3564, -3622, -3681, -3739, -3797, -3855, -3913, -3971, -4029,
-4086, -4143, -4200, -4257, -4314, -4371, -4427, -4483, -4539, -4595,
-4651, -4707, -4762, -4817, -4872, -4927, -4981, -5036, -5090, -5144,
-5198, -5251, -5305, -5358, -5411, -5463, -5516, -5568, -5620, -5672,
-5724, -5775, -5826, -5877, -5928, -5979, -6029, -6079, -6129, -6178,
-6227, -6276, -6325, -6374, -6422, -6470, -6518, -6565, -6613, -6660,
-6706, -6753, -6799, -6845, -6891, -6936, -6981, -7026, -7071, -7115,
-7159, -7203, -7246, -7289, -7332, -7375, -7417, -7459, -7501, -7542,
-7583, -7624, -7664, -7705, -7745, -7784, -7823, -7862, -7901, -7939,
-7977, -8015, -8053, -8090, -8126, -8163, -8199, -8235, -8270, -8305,
-8340, -8375, -8409, -8443, -8476, -8509, -8542, -8575, -8607, -8639,
-8670, -8701, -8732, -8763, -8793, -8822, -8852, -8881, -8910, -8938,
-8966, -8994, -9021, -9048, -9074, -9101, -9126, -9152, -9177, -9202,
-9226, -9250, -9274, -9297, -9320, -9343, -9365, -9387, -9408, -9429,
-9450, -9470, -9490, -9510, -9529, -9548, -9567, -9585, -9602, -9620,
-9637, -9653, -9670, -9685, -9701, -9716, -9730, -9745, -9759, -9772,
-9785, -9798, -9810, -9822, -9834, -9845, -9856, -9866, -9876, -9886,
-9895, -9904, -9913, -9921, -9928, -9936, -9943, -9949, -9955, -9961,
-9966, -9971, -9976, -9980, -9984, -9987, -9990, -9992, -9995, -9996,
-9998, -9999, -9999, -10000, -9999, -9999, -9998, -9996, -9995, -9992,
-9990, -9987, -9984, -9980, -9976, -9971, -9966, -9961, -9955, -9949,
-9943, -9936, -9928, -9921, -9913, -9904, -9895, -9886, -9876, -9866,
-9856, -9845, -9834, -9822, -9810, -9798, -9785, -9772, -9759, -9745,
-9730, -9716, -9701, -9685, -9670, -9653, -9637, -9620, -9602, -9585,
-9567, -9548, -9529, -9510, -9490, -9470, -9450, -9429, -9408, -9387,
-9365, -9343, -9320, -9297, -9274, -9250, -9226, -9202, -9177, -9152,
-9126, -9101, -9074, -9048, -9021, -8994, -8966, -8938, -8910, -8881,
-8852, -8822, -8793, -8763, -8732, -8701, -8670, -8639, -8607, -8575,
-8542, -8509, -8476, -8443, -8409, -8375, -8340, -8305, -8270, -8235,
-8199, -8163, -8126, -8090, -8053, -8015, -7977, -7939, -7901, -7862,
-7823, -7784, -7745, -7705, -7664, -7624, -7583, -7542, -7501, -7459,
-7417, -7375, -7332, -7289, -7246, -7203, -7159, -7115, -7071, -7026,
-6981, -6936, -6891, -6845, -6799, -6753, -6706, -6660, -6613, -6565,
-6518, -6470, -6422, -6374, -6325, -6276, -6227, -6178, -6129, -6079,
-6029, -5979, -5928, -5877, -5826, -5775, -5724, -5672, -5620, -5568,
-5516, -5463, -5411, -5358, -5305, -5251, -5198, -5144, -5090, -5036,
-4981, -4927, -4872, -4817, -4762, -4707, -4651, -4595, -4539, -4483,
-4427, -4371, -4314, -4257, -4200, -4143, -4086, -4029, -3971, -3913,
-3855, -3797, -3739, -3681, -3622, -3564, -3505, -3446, -3387, -3328,
-3268, -3209, -3149, -3090, -3030, -2970, -2910, -2850, -2789, -2729,
-2669, -2608, -2547, -2486, -2425, -2364, -2303, -2242, -2181, -2120,
-2058, -1997, -1935, -1873, -1812, -1750, -1688, -1626, -1564, -1502,
-1440, -1377, -1315, -1253, -1190, -1128, -1066, -1003, -941, -878, -815,
-753, -690, -627, -565, -502, -439, -376, -314, -251, -188, -125, -62, 0,
62, 125, 188, 251, 314, 376, 439, 502, 565, 627, 690, 753, 815, 878, 941,
1003, 1066, 1128, 1190, 1253, 1315, 1377, 1440, 1502, 1564, 1626, 1688,
1750, 1812, 1873, 1935, 1997, 2058, 2120, 2181, 2242, 2303, 2364, 2425,
2486, 2547, 2608, 2669, 2729, 2789, 2850, 2910, 2970, 3030, 3090, 3149,
3209, 3268, 3328, 3387, 3446, 3505, 3564, 3622, 3681, 3739, 3797, 3855,
3913, 3971, 4029, 4086, 4143, 4200, 4257, 4314, 4371, 4427, 4483, 4539,
4595, 4651, 4707, 4762, 4817, 4872, 4927, 4981, 5036, 5090, 5144, 5198,
5251, 5305, 5358, 5411, 5463, 5516, 5568, 5620, 5672, 5724, 5775, 5826,
5877, 5928, 5979, 6029, 6079, 6129, 6178, 6227, 6276, 6325, 6374, 6422,
6470, 6518, 6565, 6613, 6660, 6706, 6753, 6799, 6845, 6891, 6936, 6981,
7026, 7071, 7115, 7159, 7203, 7246, 7289, 7332, 7375, 7417, 7459, 7501,
7542, 7583, 7624, 7664, 7705, 7745, 7784, 7823, 7862, 7901, 7939, 7977,
8015, 8053, 8090, 8126, 8163, 8199, 8235, 8270, 8305, 8340, 8375, 8409,
8443, 8476, 8509, 8542, 8575, 8607, 8639, 8670, 8701, 8732, 8763, 8793,
8822, 8852, 8881, 8910, 8938, 8966, 8994, 9021, 9048, 9074, 9101, 9126,
9152, 9177, 9202, 9226, 9250, 9274, 9297, 9320, 9343, 9365, 9387, 9408,
9429, 9450, 9470, 9490, 9510, 9529, 9548, 9567, 9585, 9602, 9620, 9637,
9653, 9670, 9685, 9701, 9716, 9730, 9745, 9759, 9772, 9785, 9798, 9810,
9822, 9834, 9845, 9856, 9866, 9876, 9886, 9895, 9904, 9913, 9921, 9928,
9936, 9943, 9949, 9955, 9961, 9966, 9971, 9976, 9980, 9984, 9987, 9990,
9992, 9995, 9996, 9998, 9999, 9999};

process MAIN enabled
    {
    degrees = 0;
    spawn SINE_COSINE;
    degrees = 45;
    spawn SINE_COSINE;
    degrees = 120;
    spawn SINE_COSINE;
    degrees = 180;
    spawn SINE_COSINE;
    degrees = 360;
    spawn SINE_COSINE;
    degrees = 450;
    spawn SINE_COSINE;
    }

process SINE_COSINE
    {
    cosindex = ((1000 * degrees) / 360) % 1000;
    cos1 = cosine[cosindex];

    sinindex = cosindex - 250;
    if (sinindex < 0)
        sinindex = sinindex + 1000;
    sin1 = cosine[sinindex];

    printf("(sin(%d),cos(%d)) is (%d/10000,%d/10000)\n", degrees, degrees, sin1, cos1);
    }
